(("undefined"!==typeof self?self:this)["webpackChunknutanix_1_1_3"]=("undefined"!==typeof self?self:this)["webpackChunknutanix_1_1_3"]||[]).push([[921],{1177:function(e,t,i){var a={"./classic/metadata.json":9621,"./csp/metadata.json":6471,"./federal/metadata.json":1862,"./harvester/metadata.json":1507,"./rgs/metadata.json":8401,"./suse/metadata.json":7259};function s(e){var t=n(e);return i(t)}function n(e){if(!i.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}s.keys=function(){return Object.keys(a)},s.resolve=n,e.exports=s,s.id=1177},1210:function(e,t,i){"use strict";i.d(t,{S:function(){return r},Y:function(){return c}});var a=i(5250),s=i(4364);function n(e,t,i){return(t=o(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function o(e){var t=l(e,"string");return"symbol"==typeof t?t:t+""}function l(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var a=i.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}const r="X-ntnx-api-key";class c{constructor(e,t){n(this,"endpoint",""),n(this,"username",""),n(this,"password",""),n(this,"port",""),n(this,"insecure",!1),n(this,"clusterReferenceId",""),n(this,"credentialID",""),n(this,"endpoints",void 0),n(this,"$dispatch",void 0),t.nutanixcredentialConfig?(Object.keys(t.nutanixcredentialConfig).forEach((e=>{this[e]=t.nutanixcredentialConfig[e]})),this.credentialID=t.id):Object.keys(t).forEach((e=>{this[e]=t[e]})),this.$dispatch=e.dispatch}async testConnection(){const e=`/meta/proxy/${this.endpoint}:${this.port}`,t=`${e}/api/clustermgmt/v4.0/config/clusters`,i={Accept:"application/json"};this.username===r?i[r]=this.password:i["X-API-Auth-Header"]="Basic "+btoa(this.username+":"+this.password);try{const e=await this.$dispatch("management/request",{url:t,headers:i,method:"GET",redirectUnauthorized:!1},{root:!0});return 502===e._status?{error:"Could not proxy request - URL may not be in Rancher's allow list"}:e}catch(a){return s.error(a),{error:a}}}async getClusterList(e,t){return await this.getOptions({value:e,api:"/api/clustermgmt/v4.0/config/clusters",field:"data",filter:e=>e.config.hypervisorTypes.includes("AHV"),initial:t})}async getImages(e,t){return await this.getOptions({value:e,api:"/api/vmm/v4.0/content/images",field:"data",initial:t})}async getNetwork(e,t){return await this.getOptions({value:e,api:"/api/networking/v4.0/config/subnets",field:"data",mapper:async e=>{const t="OVERLAY"===e.subnetType?(await this.getVpc(e.vpcReference)).data:void 0;return{...e,baseName:e.name,name:"OVERLAY"===e.subnetType?`${e.name} (${t.name})`:e.name}},filter:e=>("OVERLAY"==e.subnetType||e.clusterReference==this.clusterReferenceId||e?.clusterReferenceList.includes(this.clusterReferenceId))&&!e.isExternal,initial:t})}async getVpc(e){return await this.makeComputeRequest(`/api/networking/v4.0/config/vpcs/${e}`)}async getStorageContainer(e,t){return await this.getOptions({value:e,api:"/api/clustermgmt/v4.0/config/storage-containers",field:"data",filter:e=>e.clusterExtId==this.clusterReferenceId,initial:t})}async getCategories(e,t){return await this.getOptions({value:e,api:"/api/prism/v4.0/config/categories",field:"data",mapper:e=>({...e,name:`${e.key}=${e.value}`}),filter:e=>"Project"!==e.key,initial:t})}async getProjectsName(e,t){return await this.getOptions({value:e,api:"/api/nutanix/v3/projects/list",field:"entities",mapper:e=>({...e,name:`${e.spec.name}`}),initial:t})}async constructTotalResponse(e,t,i){const a=Math.ceil(i/t),s=[];for(let n=1;n<a;n++){const t=await this.makeComputeRequest(`${e}?$page=${n}`);s.push(...t.data)}return s}async constructProjectTotalResponse(e,t,i){const a=Math.ceil(i/t),s=[];for(let n=1;n<a;n++){const t=await this.makeComputeRequest(`${e}?$page=${n}`,"POST");s.push(...t.entities)}return s}async getOptions(e){const{value:t,api:i,mapper:s,filter:n,initial:o,field:l}=e;let r;if(t.busy=!0,t.enabled=!0,t.selected=(0,a.isArray)(t.selected)?[]:"","/api/nutanix/v3/projects/list"===i){r=await this.makeComputeRequest(i,"POST");const e=r?.metadata?.total_matches??0,t=r?.entities?.length??0;if(t<e){const a=await this.constructProjectTotalResponse(i,t,e);r.entities=[...r.entities,...a]}}else{r=await this.makeComputeRequest(i);const e=r?.metadata?.totalAvailableResults??0,t=r?.data?.length??0;if(t<e){const a=await this.constructTotalResponse(i,t,e);r.data=[...r.data,...a]}}if(r&&r[l]){let e=r[l]||[];if(n&&(e=e.filter((e=>n(e)))),s&&(e=await Promise.all(e.map((async e=>await s(e))))),t.options.forEach((t=>{e.push(t)})),t.options=this.convertToOptions(e),t.busy=!1,t.options.length<e.length){const i=e.filter(((t,i)=>i!==e.findIndex((e=>t.name===e.name))));t.duplicates=i}if(o){const e=t.options.find((e=>e.value.name===o));e&&(t.selected=e.value)}}else t.options=[],t.selected=(0,a.isArray)(t.selected)?[]:null,t.busy=!1,t.enabled=!1}async makeComputeRequest(e,t="GET"){const i=`/meta/proxy/${this.endpoint}:${this.port}`,a=`${i}${e}`,n={Accept:"application/json","Content-Type":"application/json"};this.username===r?n[r]=this.password:n["X-API-Auth-Header"]="Basic "+btoa(this.username+":"+this.password);try{const e=await this.$dispatch("management/request",{url:a,headers:n,method:t,data:JSON.stringify({}),redirectUnauthorized:!1},{root:!0});return e}catch(o){s.error(o)}}convertToOptions(e){const t=e.filter(((t,i)=>i===e.findIndex((e=>t.name===e.name)))),i=(t||[]).sort(((e,t)=>e.name.localeCompare(t.name)));return i.map((e=>({label:e.name,value:e})))}}},3341:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return se}});var a=i(9274);const s={class:"nutanix-config"},n={class:"title"},o={key:0,class:"loading"},l={key:1,class:"loading"},r={key:2,class:"loading"},c={class:"row mt-10"},d={class:"col span-6"},u={class:"col span-6"},m={class:"nutanix-config"},p={class:"title"},v={class:"row mt-10"},h={class:"col span-4"},g={class:"col span-4"},f={class:"col span-4"},b={class:"row mt-10"},y={class:"col span-6"},C={class:"col span-6"},k={class:"row mt-10",style:{"align-items":"center"}},w={class:"col span-6"},x={class:"col span-6",style:{"padding-left":"10px"}},N={class:"nutanix-config"},I={class:"title"},S={class:"row mt-10"},E={class:"col span-12"},V={class:"row"},z={class:"col span-6"},A={class:"col span-6"},j={class:"nutanix-config"},O={class:"title"},P={class:"row mt-10"},T={class:"col span-12"},R={key:1};function D(e,t,i,D,$,U){const _=(0,a.resolveComponent)("Loading"),B=(0,a.resolveComponent)("LabeledSelect"),M=(0,a.resolveComponent)("UnitInput"),q=(0,a.resolveComponent)("Checkbox"),L=(0,a.resolveComponent)("RadioGroup"),K=(0,a.resolveComponent)("Collapse"),W=(0,a.resolveComponent)("CodeMirror"),Y=(0,a.resolveComponent)("Banner");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[e.$fetchState.pending?((0,a.openBlock)(),(0,a.createBlock)(_,{key:0,delayed:!0})):(0,a.createCommentVNode)("",!0),(0,a.createElementVNode)("div",null,[(0,a.createElementVNode)("div",s,[(0,a.createElementVNode)("div",n,(0,a.toDisplayString)(e.t("driver.nutanix.config.title.main")),1),e.authenticating&&!e.ready?((0,a.openBlock)(),(0,a.createElementBlock)("div",o,[t[22]||(t[22]=(0,a.createElementVNode)("i",{class:"icon-spinner icon-spin icon-lg"},null,-1)),(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(e.t("driver.nutanix.config.loggin.loading")),1)])):e.authenticating&&e.ready?((0,a.openBlock)(),(0,a.createElementBlock)("div",l,[t[23]||(t[23]=(0,a.createElementVNode)("i",{class:"icon-checkmark icon-lg",style:{color:"green"}},null,-1)),(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(e.t("driver.nutanix.config.loggin.success")),1)])):((0,a.openBlock)(),(0,a.createElementBlock)("div",r,[t[24]||(t[24]=(0,a.createElementVNode)("i",{class:"icon-close icon-lg",style:{color:"red"}},null,-1)),(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(e.t("driver.nutanix.config.loggin.failed")),1)]))]),(0,a.createElementVNode)("div",c,[(0,a.createElementVNode)("div",d,[(0,a.createVNode)(B,{value:e.projectName.selected,"onUpdate:value":[t[0]||(t[0]=t=>e.projectName.selected=t),t[1]||(t[1]=e=>{U.dynamicProjectName(e),U.canAuthenticate()})],labelKey:"driver.nutanix.config.component.projectName.label",placeholder:e.t("driver.nutanix.config.component.projectName.placeholder"),options:e.projectName.options,disabled:!e.projectName.enabled||e.mybusy,loading:e.projectName.busy,searchable:!1},null,8,["value","placeholder","options","disabled","loading"])]),(0,a.createElementVNode)("div",u,[(0,a.createVNode)(B,{value:e.clusters.selected,"onUpdate:value":[t[2]||(t[2]=t=>e.clusters.selected=t),t[3]||(t[3]=e=>{U.setClusterReferenceId(e),U.canAuthenticate()})],labelKey:"driver.nutanix.config.component.cluster.label",placeholder:e.t("driver.nutanix.config.component.cluster.placeholder"),options:e.clusters.options,disabled:!e.clusters.enabled||e.mybusy,loading:e.clusters.busy,searchable:!1,required:!0},null,8,["value","placeholder","options","disabled","loading"])])]),t[25]||(t[25]=(0,a.createElementVNode)("hr",{class:"mt-10"},null,-1)),(0,a.createElementVNode)("div",m,[(0,a.createElementVNode)("div",p,(0,a.toDisplayString)(e.t("driver.nutanix.config.title.properties")),1)]),(0,a.createElementVNode)("div",v,[(0,a.createElementVNode)("div",h,[(0,a.createVNode)(M,{value:e.vmCpus.selected,labelKey:"driver.nutanix.config.component.vmCpus.label",suffix:e.t("driver.nutanix.config.component.vmCpus.suffix"),type:"number",disabled:!e.vmCpus.enabled||e.mybusy,loading:e.vmCpus.busy,required:!0,min:e.vmCpus.min,max:e.vmCpus.max,"onUpdate:value":t[4]||(t[4]=t=>{U.validInput(t,e.vmCpus),U.canAuthenticate()}),status:e.vmCpus.status,tooltip:e.vmCpus.tooltip},null,8,["value","suffix","disabled","loading","min","max","status","tooltip"]),(0,a.createVNode)(q,{value:e.vmCpuPassthrough,valueWhenTrue:!0,labelKey:"driver.nutanix.config.component.vmCpuPassthrough.label",style:{"margin-top":"5px"},"onUpdate:value":t[5]||(t[5]=t=>{e.vmCpuPassthrough=!e.vmCpuPassthrough}),disabled:e.mybusy},null,8,["value","disabled"])]),(0,a.createElementVNode)("div",g,[(0,a.createVNode)(M,{value:e.vmCores.selected,labelKey:"driver.nutanix.config.component.vmCores.label",suffix:e.t("driver.nutanix.config.component.vmCores.suffix"),type:"number",disabled:!e.vmCores.enabled||e.mybusy,loading:e.vmCores.busy,required:!0,min:e.vmCores.min,max:e.vmCores.max,"onUpdate:value":t[6]||(t[6]=t=>{U.validInput(t,e.vmCores),U.canAuthenticate()}),status:e.vmCores.status,tooltip:e.vmCores.tooltip},null,8,["value","suffix","disabled","loading","min","max","status","tooltip"])]),(0,a.createElementVNode)("div",f,[(0,a.createVNode)(M,{value:e.vmMem.selected,labelKey:"driver.nutanix.config.component.vmMem.label",suffix:e.t("driver.nutanix.config.component.vmMem.suffix"),type:"number",disabled:!e.vmMem.enabled||e.mybusy,loading:e.vmMem.busy,required:!0,min:e.vmMem.min,max:e.vmMem.max,"onUpdate:value":t[7]||(t[7]=t=>{U.validInput(t,e.vmMem),U.canAuthenticate()}),status:e.vmMem.status,tooltip:e.vmMem.tooltip},null,8,["value","suffix","disabled","loading","min","max","status","tooltip"])])]),(0,a.createElementVNode)("div",b,[(0,a.createElementVNode)("div",y,[(0,a.createVNode)(B,{value:e.vmImage.selected,"onUpdate:value":[t[8]||(t[8]=t=>e.vmImage.selected=t),t[9]||(t[9]=e=>{U.dynamicVmImageSize(e),U.canAuthenticate()})],labelKey:"driver.nutanix.config.component.vmImage.label",placeholder:e.t("driver.nutanix.config.component.vmImage.placeholder"),options:e.vmImage.options,disabled:!e.vmImage.enabled||e.mybusy,loading:e.vmImage.busy,searchable:!1,required:!0,status:e.vmImage.status,tooltip:e.vmImage.tooltip},null,8,["value","placeholder","options","disabled","loading","status","tooltip"])]),(0,a.createElementVNode)("div",C,[(0,a.createVNode)(M,{value:e.vmImageSize.selected,labelKey:"driver.nutanix.config.component.vmImageSize.label",suffix:e.t("driver.nutanix.config.component.vmImageSize.suffix"),min:e.vmImageSize.min,max:e.vmImageSize.max,disabled:!e.vmImageSize.enabled||e.mybusy,loading:e.vmImageSize.busy,required:!0,type:"number","onUpdate:value":t[10]||(t[10]=t=>{U.validInput(t,e.vmImageSize),U.canAuthenticate()}),status:e.vmImageSize.status,tooltip:e.vmImageSize.tooltip},null,8,["value","suffix","min","max","disabled","loading","status","tooltip"])])]),(0,a.createElementVNode)("div",k,[(0,a.createElementVNode)("div",w,[(0,a.createVNode)(B,{value:e.networks.selected,"onUpdate:value":[t[11]||(t[11]=t=>e.networks.selected=t),t[12]||(t[12]=t=>{U.labelSelectAddWrongTag(t,e.networks),U.filterNetworks(),U.canAuthenticate()})],labelKey:"driver.nutanix.config.component.vmNetwork.label",placeholder:e.t("driver.nutanix.config.component.vmNetwork.placeholder"),taggable:!0,multiple:!0,options:e.networks.options,disabled:!e.networks.enabled||e.mybusy,loading:e.networks.busy,searchable:!0,required:!0},null,8,["value","placeholder","options","disabled","loading"])]),(0,a.createElementVNode)("div",x,[(0,a.createElementVNode)("div",N,[(0,a.createElementVNode)("div",I,(0,a.toDisplayString)(e.t("driver.nutanix.config.title.bootType")),1)]),(0,a.createVNode)(L,{name:"bootConfiguration",options:["Legacy","UEFI"],row:!0,value:e.bootType,"onUpdate:value":t[13]||(t[13]=t=>e.bootType=t),disabled:e.mybusy},null,8,["value","disabled"])])]),(0,a.createElementVNode)("div",S,[(0,a.createElementVNode)("div",E,[(0,a.createVNode)(B,{value:e.vmCategories.selected,"onUpdate:value":t[14]||(t[14]=t=>e.vmCategories.selected=t),labelKey:"driver.nutanix.config.component.vmCategories.label",placeholder:e.t("driver.nutanix.config.component.vmCategories.placeholder"),taggable:!0,multiple:!0,options:e.vmCategories.options,disabled:!e.vmCategories.enabled||e.mybusy,loading:e.vmCategories.busy,onSelecting:t[15]||(t[15]=t=>U.labelSelectAddWrongTag(t,e.vmCategories))},null,8,["value","placeholder","options","disabled","loading"])])]),(0,a.createVNode)(q,{val:"",value:e.vmSerialPort,valueWhenTrue:!0,labelKey:"driver.nutanix.config.component.vmSerialPort.label",style:{"margin-top":"5px"},"onUpdate:value":t[16]||(t[16]=t=>{e.vmSerialPort=!e.vmSerialPort}),disabled:e.mybusy},null,8,["value","disabled"]),(0,a.createVNode)(K,{open:e.is_SC_colapse,title:e.t("driver.nutanix.config.title.collapseAdditionalDisk"),"onUpdate:open":t[20]||(t[20]=t=>e.is_SC_colapse=!e.is_SC_colapse)},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",null,[(0,a.createElementVNode)("div",V,[(0,a.createElementVNode)("div",z,[(0,a.createVNode)(M,{value:e.additionalDiskSize.selected,labelKey:"driver.nutanix.config.component.diskSize.label",suffix:e.t("driver.nutanix.config.component.diskSize.suffix"),type:"number",disabled:!e.additionalDiskSize.enabled||e.mybusy,loading:e.additionalDiskSize.busy,"onUpdate:value":t[17]||(t[17]=e=>{U.dynamicStorageContainer(e),U.canAuthenticate()})},null,8,["value","suffix","disabled","loading"])]),(0,a.createElementVNode)("div",A,[(0,a.createVNode)(B,{value:e.storageContainer.selected,"onUpdate:value":[t[18]||(t[18]=t=>e.storageContainer.selected=t),t[19]||(t[19]=e=>U.canAuthenticate())],labelKey:"driver.nutanix.config.component.storageContainer.label",placeholder:e.t("driver.nutanix.config.component.storageContainer.placeholder"),options:e.storageContainer.options,disabled:!e.additionalDiskSize.selected||!e.storageContainer.enabled||e.mybusy,loading:e.storageContainer.busy,searchable:!1},null,8,["value","placeholder","options","disabled","loading"])])])])])),_:1},8,["open","title"]),t[26]||(t[26]=(0,a.createElementVNode)("hr",{class:"mt-10"},null,-1)),(0,a.createElementVNode)("div",j,[(0,a.createElementVNode)("div",O,(0,a.toDisplayString)(e.t("driver.nutanix.config.title.cloudInit")),1)]),(0,a.createElementVNode)("div",P,[(0,a.createElementVNode)("div",T,[(0,a.createVNode)(W,{style:{background:"#f5f5f5"},mode:"edit",minHeight:"5",value:e.cloudInit,options:e.mybusy?{readOnly:!0,cursorBlinkRate:-1}:{readOnly:!1},asTextArea:!1,onOnInput:t[21]||(t[21]=t=>e.cloudInit=t)},null,8,["value","options"])])])]),e.errors.length?((0,a.openBlock)(),(0,a.createElementBlock)("div",R,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.errors,((e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:t},[(0,a.createVNode)(Y,{color:"error",label:U.stringify(e)},null,8,["label"])])))),128))])):(0,a.createCommentVNode)("",!0)])}var $=i(2570),U=i(9980),B=i(6414),M=i(3495),q=i(7193),L=i(7949),K=i(6625),W=i(507),Y=i(827),F=i(5664),G=i(9726),H=i(4220),J=i(1210),X=i(8724),Q=i(4364);function Z(e=!1,t=null,i=[]){return{options:i,selected:t,busy:!1,enabled:e,baseOption:null}}function ee(e=!1,t=null,i=null,a=null){return{options:[],selected:t,min:i,max:a,busy:!1,enabled:e,status:"",tooltip:""}}var te={components:{Banner:U.l,Loading:$.A,KeyValue:q.A,LabeledSelect:M.A,UnitInput:X.A,CodeMirror:L.A,Collapse:K.A,Checkbox:W.A,RadioGroup:Y.A},mixins:[B.A],props:{uuid:{type:String,required:!0},cluster:{type:Object,default:()=>({})},credentialId:{type:String,required:!0},disabled:{type:Boolean,default:!1},busy:{type:Boolean,default:!1},provider:{type:String,required:!0}},emits:["validationChanged"],async fetch(){this.credentialId&&(this.$emit("validationChanged",!1),this.mode!=H.YQ?(await this.initAuthentication(),this.clusters.selected=this.clusters.baseOption.filter((e=>e.label==this.value.cluster))[0],void 0!==this.clusters.selected&&(await this.setClusterReferenceId(this.clusters.selected.value),this.projectName.selected=this.projectName.options.find((e=>e.value.name===this.value.project))?.value,this.vmCpus.selected=this.value.vmCpus,this.vmCpuPassthrough=this.value.vmCpuPassthrough,this.vmCores.selected=this.value.vmCores,this.vmMem.selected=this.value.vmMem/1024,this.vmImage.selected=this.vmImage.options.find((e=>e.value.name===this.value.vmImage))?.value,this.vmImageSize.selected=this.value.vmImageSize,this.networks.selected=this.value.vmNetwork.map((e=>this.networks.baseOption.find((t=>t.value.extId===e||t.extId===e||t.label===e)))),this.filterNetworks(),this.bootType="legacy"===this.value.bootType?"Legacy":"UEFI",this.vmCategories.selected=this.value.vmCategories.map((e=>this.vmCategories.options.find((t=>t.name===e||t.value?.name===e)))),this.vmSerialPort=this.value.vmSerialPort,this.additionalDiskSize.selected=this.value.diskSize,0!==this.additionalDiskSize.selected&&null!==this.additionalDiskSize.selected&&(this.storageContainer.selected=this.storageContainer.options.find((e=>e.value.containerExtId===this.value.storageContainer))),this.cloudInit=this.value.cloudInit,this.$emit("validationChanged",!0),this.mode==H.nW&&(this.mybusy=!0))):this.initAuthentication())},data(){return this.InitData()},watch:{credentialId(){this.$fetch()},value(e,t){t.vmCategories,t.vmNetwork;this.vmCategories.selected.length?this.value.vmCategories=void 0===this.vmCategories.selected[0]?.label?this.vmCategories.selected.map((e=>e.name)):this.vmCategories.selected.map((e=>e.value.name)):this.value.vmCategories=[];const i=_.uniq(this.value.vmNetwork);this.value.vmNetwork=[...i]}},computed:{value(){return this.value}},methods:{stringify:G.As,async initAuthentication(){let e=this.InitData();Object.keys(e).forEach((t=>{this[t]=e[t]}));try{this.credential=await this.$store.dispatch("rancher/find",{type:F.k$.CLOUD_CREDENTIAL,id:this.credentialId})}catch(i){this.credential=null}try{const e=this.credentialId.replace(":","/"),t=await this.$store.dispatch("management/find",{type:F.bB,id:e}),i=t.data["nutanixcredentialConfig-password"],a=atob(i);this.password=a,this.havePassword=!0,this.ready=!0}catch(i){this.password="",this.havePassword=!1,Q.error(i)}this["authenticating"]=!0;const t=new J.Y(this.$store,this.credential);t.password=this.password,this.os=t,await this.setConfiguration()},InitData(){return{authenticating:!1,ready:!1,os:null,password:null,havePassword:!1,clusters:Z(),clusterReferenceId:"",projectName:Z(!0,null,[{name:"-- NO PROJECT --"}]),vmCpus:ee(!0,"2",2,128),vmCpuPassthrough:!1,vmCores:ee(!0,"1",1,128),vmMem:ee(!0,"4",4,512),vmImage:Z(),vmImageSize:ee(!0,"0",0,1e4),networks:Z(!1,[]),additionalDiskSize:Z(!1,0),storageContainer:Z(),is_SC_colapse:!1,cloudInit:"#cloud-config\n\n",vmCategories:Z(!1,[]),vmSerialPort:!1,bootType:"Legacy",t:this.$store.getters["i18n/t"],mybusy:!1,errors:[]}},async setConfiguration(){if(await this.os.getProjectsName(this.projectName,this.value?.projectName),!this.projectName.enabled)return this["authenticating"]=!1,void this.errors.push("Unable to get Nutanix Projects Name");await this.os.getClusterList(this.clusters,this.value?.clusterName).then((()=>{this.clusters.enabled||this.errors.push("Unable to get Nutanix cluster"),this.clusters.baseOption=this.clusters.options,this.networks.enabled=!1})),await this.os.getImages(this.vmImage,this.value?.imageName).then((()=>{this.vmImage.enabled||this.errors.push("Unable to get Nutanix Images")})),await this.os.getCategories(this.vmCategories,this.value?.vmCategories).then((()=>{this.vmCategories.enabled||this.errors.push("Unable to get Nutanix vmCategories")}))},async setClusterReferenceId(e){this.os.clusterReferenceId=e.extId,this.networks.options=[],this.storageContainer.options=[],await this.os.getNetwork(this.networks,this.value?.vmNetwork).then((()=>{if(this.networks.enabled||this.errors.push("Unable to get Nutanix Network"),this.networks.baseOption=this.networks.options,this.projectName.selected){let e=this.projectName.selected.status.resources.subnet_reference_list.map((e=>e.uuid));this.networks.options=this.networks.baseOption.filter((t=>e.includes(t.value.extId))),this.networks.baseOption=this.networks.options}0===this.networks.options.length?this.networks.enabled=!1:this.networks.enabled=!0})),await this.os.getStorageContainer(this.storageContainer,this.value?.storageContainer).then((()=>{this.storageContainer.enabled||this.errors.push("Unable to get Nutanix storageContainer"),this.additionalDiskSize.enabled=!0}))},dynamicProjectName(e){if("-- NO PROJECT --"==this.projectName.selected?.name)this.projectName.selected=null,this.clusters.options=this.clusters.baseOption;else{let t=e.status.resources.cluster_reference_list.map((e=>e.uuid));this.clusters.options=this.clusters.baseOption.filter((e=>t.includes(e.value.extId)))}this.clusters.selected=null,this.networks.selected=[],this.networks.enabled=!1,this.additionalDiskSize.selected=0,this.additionalDiskSize.enabled=!1,this.storageContainer.selected=null,0===this.clusters.options.length?this.clusters.enabled=!1:this.clusters.enabled=!0},dynamicVmImageSize(e){this.vmImageSize.min=10+Math.ceil(e.sizeBytes/1073741824),this.vmImageSize.selected=10+Math.ceil(e.sizeBytes/1073741824),void 0!==this.vmImage?.duplicates?.find((t=>t.name===e.name))?(this.vmImage.status="warning",this.vmImage.tooltip=this.t("driver.nutanix.config.component.vmImage.duplicates")):(this.vmImage.status="",this.vmImage.tooltip="")},filterNetworks(){0!==this.networks.selected.length?this.networks.selected[0]?.subnetType?this.networks.options=this.networks.baseOption.filter((e=>{const t=this.networks.selected[0];return t.subnetType===e.value.subnetType&&t.vpcReference===e.value.vpcReference&&t.isAdvancedNetworking===e.value.isAdvancedNetworking})):(this.networks.selected=this.networks.selected.filter((e=>e.value)),this.networks.options=this.networks.baseOption.filter((e=>{const t=this.networks.selected[0];return t.value.subnetType===e.value.subnetType&&t.value.vpcReference==e.value.vpcReference&&t.value.isAdvancedNetworking===e.value.isAdvancedNetworking}))):this.networks.options=this.networks.baseOption},dynamicStorageContainer(e){this.additionalDiskSize.selected=e,0!==this.additionalDiskSize.selected&&null!==this.additionalDiskSize.selected?this.storageContainer.enabled=!0:this.storageContainer.enabled=!1},labelSelectAddWrongTag(e,t){t.selected=e?.filter((e=>e))||[]},syncValue(){this.value.cluster=this.clusters.selected?.value?.name??this.clusters.selected.name,this.value.project="-- NO PROJECT --"==this.projectName.selected?.name?null:this.projectName.selected?.name,this.value.vmCpus=this.vmCpus.selected.toString(),this.value.vmCpuPassthrough=this.vmCpuPassthrough,this.value.vmCores=this.vmCores.selected.toString(),this.value.vmMem=(1024*this.vmMem.selected).toString(),this.value.vmImage=this.vmImage.selected?.name,this.value.vmImageSize=this.vmImageSize.selected.toString();const e=_.uniq(this.networks.selected.map((e=>e.extId||e.value.extId)));this.value.vmNetwork=e,this.value.bootType=this.bootType.toLowerCase(),this.vmCategories.selected.length?this.value.vmCategories=void 0===this.vmCategories.selected[0]?.label?this.vmCategories.selected.map((e=>e.name)):this.vmCategories.selected.map((e=>e.value.name)):this.value.vmCategories=[],this.value.vmSerialPort=this.vmSerialPort,null!==this.additionalDiskSize.selected?this.value.diskSize=this.additionalDiskSize.selected.toString():this.value.diskSize=this.additionalDiskSize.selected,0!==this.additionalDiskSize.selected&&null!==this.additionalDiskSize.selected&&(this.value.storageContainer=this.storageContainer.selected?.containerExtId),this.value.cloudInit=this.cloudInit},validInput(e,t){t.selected=e,t.selected<t.min||t.selected>t.max?(t.status="error",t.tooltip=this.t("driver.nutanix.config.component.vmCpus.tooltip")+` (${t.min} - ${t.max})`):(t.status="",t.tooltip="")},canAuthenticate(){(0===this.additionalDiskSize.selected||null===this.additionalDiskSize.selected||""!==this.storageContainer.selected)&&this.clusters.selected&&this.vmCpus.selected&&this.vmCores.selected&&this.vmMem.selected&&this.vmImage.selected&&this.vmImageSize.selected&&this.networks.selected.length>0?this.$emit("validationChanged",!0):this.$emit("validationChanged",!1)},test(){this.syncValue()}}},ie=(i(4297),i(7433));const ae=(0,ie.A)(te,[["render",D],["__scopeId","data-v-62e2adb9"]]);var se=ae},4297:function(e,t,i){var a=i(9145);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);var s=i(4825).A;s("12f2af15",a,!0,{sourceMap:!1,shadowMode:!1})},9145:function(e,t,i){"use strict";i.r(t);var a=i(429),s=i.n(a),n=i(1214),o=i.n(n),l=o()(s());l.push([e.id,".file-button[data-v-62e2adb9]{align-items:center;position:absolute;top:0;right:0;height:100%;display:flex}.file-button>.file-selector[data-v-62e2adb9]{height:59px;border-top-left-radius:0;border-bottom-left-radius:0}.nutanix-config[data-v-62e2adb9]{display:flex;align-items:center}.nutanix-config>.title[data-v-62e2adb9]{font-weight:700;padding:4px 0}.nutanix-config>.loading[data-v-62e2adb9]{margin-left:20px;display:flex;align-items:center}.nutanix-config>.loading>i[data-v-62e2adb9]{margin-right:4px}",""]),t["default"]=l}}]);
//# sourceMappingURL=nutanix-1.1.3.umd.min.machine-config.js.map