{"version":3,"file":"nutanix-1.0.0.umd.min.cloud-credential.js","mappings":"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","sources":["webpack://nutanix-1.0.0/./cloud-credential/nutanix.vue?126b","webpack://nutanix-1.0.0/./nutanix.ts","webpack://nutanix-1.0.0/./cloud-credential/nutanix.vue","webpack://nutanix-1.0.0/./cloud-credential/nutanix.vue?beab","webpack://nutanix-1.0.0/./cloud-credential/nutanix.vue?542a"],"sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??clonedRuleSet-23.use[1]!../../../node_modules/vue-loader/dist/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-23.use[4]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[1]!./nutanix.vue?vue&type=style&index=0&id=3f092f46&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"d73cd9a6\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","import { isArray } from \"lodash\";\n\ntype Options = {\n  value: any;\n  api: string;\n  field: string;\n  mapper?: Function;\n  filter?: Function;\n  initial?: string;\n  name?: string;\n}\n/**\n * Helper class for dealing with the nutanix API\n */\nexport class Nutanix {\n  public endpoint: string = '';\n  public username: string = '';\n  public password: string = '';\n  public port: string = '';\n  public insecure: boolean = false;\n  public clusterReferenceId: string = '';\n  private credentialID: string = '';\n  private endpoints: any;\n\n  private $dispatch: any;\n\n  constructor($store: any, obj: any) {\n    if (obj.nutanixcredentialConfig) {\n      Object.keys(obj.nutanixcredentialConfig).forEach((key) => {\n        (this as any)[key] = obj.nutanixcredentialConfig[key];\n      });\n      this.credentialID = obj.id;\n    } else {\n      // Copy from options to this\n      Object.keys(obj).forEach((key) => {\n        (this as any)[key] = obj[key];\n      });\n    }\n\n    this.$dispatch = $store.dispatch;\n  }\n\n  public async testConnection() {\n    const baseUrl = `/meta/proxy/${this.endpoint}:${this.port}`;\n    const url = `${baseUrl}/api/clustermgmt/v4.0/config/clusters`;\n    const headers = {\n      Accept: 'application/json',\n      \"X-API-Auth-Header\": 'Basic ' + btoa(this.username + ':' + this.password)\n    };\n\n    try {\n      const res = await this.$dispatch('management/request', {\n        url,\n        headers,\n        method: 'GET',\n        redirectUnauthorized: false,\n      }, { root: true });\n\n      if (res._status === 502) {\n        return { error: 'Could not proxy request - URL may not be in Rancher\\'s allow list' };\n      }\n\n      return res;\n\n    } catch (e) {\n      console.error(e); // eslint-disable-line no-console\n      return { error: e };\n    }\n  }\n\n  public async getClusterList(value: any, initial?: string) {\n    return await this.getOptions({\n      value,\n      api: \"/api/clustermgmt/v4.0/config/clusters\",\n      field: 'data',\n      filter: (cluster: any) => cluster.config.hypervisorTypes.includes(\"AHV\"),\n      initial\n    });\n  }\n\n  public async getImages(value: any, initial?: string) {\n    return await this.getOptions({\n      value,\n      api: '/api/vmm/v4.0/content/images',\n      field: 'data',\n      initial\n    });\n  }\n\n  public async getNetwork(value: any, initial?: string) {\n    return await this.getOptions({\n      value,\n      api: '/api/networking/v4.0/config/subnets',\n      field: 'data',\n      mapper: async (network: any) => {\n        const vpc = network.subnetType === \"OVERLAY\" ? (await this.getVpc(network.vpcReference)).data : undefined;\n        return {\n          ...network,\n          baseName: network.name,\n          name: network.subnetType === \"OVERLAY\" ? `${network.name} (${vpc.name})` : network.name,\n        }\n      },\n      filter: (network: any) => (network.subnetType == \"OVERLAY\" || network.clusterReference == this.clusterReferenceId) && !network.isExternal,\n      initial\n    });\n  }\n\n  public async getVpc(vpcReference: string) {\n    return await this.makeComputeRequest(`/api/networking/v4.0/config/vpcs/${vpcReference}`);\n  }\n\n  public async getStorageContainer(value: any, initial?: string) {\n    return await this.getOptions({\n      value,\n      api: '/api/clustermgmt/v4.0/config/storage-containers',\n      field: 'data',\n      filter: (storage: any) => storage.clusterExtId == this.clusterReferenceId,\n      initial\n    });\n  }\n\n  public async getCategories(value: any, initial?: string) {\n    return await this.getOptions({\n      value,\n      api: '/api/prism/v4.0/config/categories',\n      field: 'data',\n      mapper: (categorie: any) => { return { ...categorie, name: `${categorie.key}=${categorie.value}` } },\n      filter: (categorie: any) => categorie.key !== \"Project\",\n      initial\n    });\n  }\n\n  public async getProjectsName(value: any, initial?: string) {\n    return await this.getOptions({\n      value,\n      api: '/api/nutanix/v3/projects/list',\n      field: 'entities',\n      mapper: (project: any) => { return { ...project, name: `${project.spec.name}` } },\n      initial\n    });\n  }\n\n  // public async getNetworkNames(value: any, initial?: string) {\n  //   return await this.getOptions(value, '/os-tenant-networks', 'networks', (network: any) => {\n  //     return {\n  //       ...network,\n  //       name: network.label\n  //     };\n  //   }, initial);\n  // }\n\n  private async constructTotalResponse(apiPath: string, initialDataLength: number, total: number) {\n    const pageCount = Math.ceil(total / initialDataLength);\n    const data = [];\n    for (let i = 1; i < pageCount; i++) {\n      const nextPageResponse = await this.makeComputeRequest(`${apiPath}?$page=${i}`);\n      data.push(...nextPageResponse.data);\n    }\n\n    return data;\n  }\n\n  private async constructProjectTotalResponse(apiPath: string, initialDataLength: number, total: number) {\n    const pageCount = Math.ceil(total / initialDataLength);\n    const entities = [];\n    for (let i = 1; i < pageCount; i++) {\n      const nextPageResponse = await this.makeComputeRequest(`${apiPath}?$page=${i}`, 'POST');\n      entities.push(...nextPageResponse.entities);\n    }\n\n    return entities;\n  }\n\n  public async getOptions(options: Options) {\n    const { value, api, mapper, filter, initial, field } = options;\n    // We are fetching the data for the options\n    value.busy = true;\n    value.enabled = true;\n    value.selected = isArray(value.selected) ? [] : '';\n\n    let res;\n\n    if (api === '/api/nutanix/v3/projects/list') {\n      res = await this.makeComputeRequest(api, 'POST');\n      const total = res?.metadata?.total_matches ?? 0;\n      const pageCount = res?.entities?.length ?? 0;\n      if (pageCount < total) {\n        const entities = await this.constructProjectTotalResponse(api, pageCount, total);\n        res.entities = [...res.entities, ...entities];\n      }\n    }\n    else {\n      res = await this.makeComputeRequest(api);\n      const total = res?.metadata?.totalAvailableResults ?? 0;\n      const pageCount = res?.data?.length ?? 0;\n\n      if (pageCount < total) {\n        const data = await this.constructTotalResponse(api, pageCount, total);\n        res.data = [...res.data, ...data];\n      }\n    }\n\n    if (res && (res as any)[field]) {\n      let list = (res as any)[field] || [];\n\n      if (filter) {\n        list = list.filter((k: any) => filter(k));\n      }\n\n      if (mapper) {\n        list = await Promise.all(list.map(async (k: any) => await mapper(k)));\n      }\n\n      value.options.forEach((selected: any) => { list.push(selected) });\n\n      value.options = this.convertToOptions(list);\n      value.busy = false;\n\n      if (value.options.length < list.length) {\n        const unique = list.filter((obj: any, index: any) => {\n          return index !== list.findIndex((o: any) => obj.name === o.name);\n        });\n        value.duplicates = unique;\n      }\n\n      if (initial) {\n        const found = value.options.find((option: any) => option.value.name === initial);\n\n        if (found) {\n          value.selected = found.value;\n        }\n      }\n\n    } else {\n      value.options = [];\n      value.selected = isArray(value.selected) ? [] : null;\n      value.busy = false;\n      value.enabled = false;\n    }\n  }\n\n  public async makeComputeRequest(api: string, method: string = 'GET') {\n    const baseUrl = `/meta/proxy/${this.endpoint}:${this.port}`;\n    const url = `${baseUrl}${api}`;\n\n    const headers = {\n      Accept: 'application/json',\n      \"Content-Type\": 'application/json',\n      \"X-API-Auth-Header\": 'Basic ' + btoa(this.username + ':' + this.password),\n    };\n\n    try {\n      const res = await this.$dispatch('management/request', {\n        url,\n        headers,\n        method: method,\n        data: JSON.stringify({}),\n        redirectUnauthorized: false,\n      }, { root: true });\n\n      return res;\n    } catch (e) {\n      console.error(e); // eslint-disable-line no-console\n    }\n  }\n\n\n  private convertToOptions(list: any) {\n    const unique = list.filter((obj: any, index: any) => {\n      return index === list.findIndex((o: any) => obj.name === o.name);\n    });\n\n    const sorted = (unique || []).sort((a: any, b: any) => a.name.localeCompare(b.name));\n\n    return sorted.map((p: any) => {\n      return {\n        label: p.name,\n        value: p\n      };\n    });\n  }\n}\n","<script>\nimport { parse as parseUrl } from '@shell/utils/url';\nimport { _CREATE } from '@shell/config/query-params';\nimport { _VIEW } from '@shell/config/query-params';\n\nimport { Nutanix } from '../nutanix.ts';\n\nimport Banner from '@components/Banner/Banner.vue';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport Checkbox from '@shell/rancher-components/Form/Checkbox/Checkbox.vue';\n\nexport default {\n  components: {\n    Banner,\n    LabeledInput,\n    LabeledSelect,\n    Checkbox,\n  },\n\n  props: {\n    mode: {\n      type:     String,\n      required: true,\n    },\n\n    value: {\n      type:     Object,\n      required: true,\n    },\n  },\n\n  async fetch() {\n    this.driver = await this.$store.dispatch('rancher/find', {\n      type: 'nodedriver',\n      id:   'nutanix'\n    });\n  },\n\n  data() {\n    return {\n      step:           1,\n      busy:           false,\n      errorAllowHost: false,\n      allowBusy:      false,\n      driver:         {},\n      error:          '',\n      success:        '',\n    };\n  },\n\n  computed: {\n\n    hostname() {\n      const u = parseUrl(this.value.decodedData.endpoint);\n\n      return u?.host || '';\n    },\n\n    // Function used to verified if we can clic on the Authenticate button\n    canAuthenticate() {\n      return !!this.value?.decodedData?.endpoint &&\n        !!this.value?.decodedData?.username &&\n        !!this.value?.decodedData?.password;\n    }\n  },\n  emits: ['validationChanged'],\n\n  methods: {\n\n    test() {\n      return true;\n    },\n\n    hostInAllowList() {\n      if (!this.driver?.whitelistDomains) {\n        return false;\n      }\n\n      const u = parseUrl(this.value.decodedData.endpoint);\n\n      if (!u.host) {\n        return true;\n      }\n\n      return (this.driver?.whitelistDomains || []).includes(u.host);\n    },\n\n    async addHostToAllowList() {\n      this['allowBusy'] = true;\n      const u = parseUrl(this.value.decodedData.endpoint);\n\n      this.driver.whitelistDomains = this.driver.whitelistDomains || [];\n\n      if (!this.hostInAllowList()) {\n        this.driver.whitelistDomains.push(u.host);\n      }\n\n      try {\n        await this.driver.save();\n\n        // this.$refs.connect.$el.click();\n\n        this['error'] = \"\";\n        this.connect();\n\n\n      } catch (e) {\n        console.error('Could not update driver', e); // eslint-disable-line no-console\n        this['allowBusy'] = false;\n      }\n\n    },\n\n    async connect() {\n      if (this.disabled) {\n        return;\n      }\n\n      this['error'] = '';\n      this['success'] = '';\n      this['errorAllowHost'] = false;\n\n      let okay = false;\n\n      if (!this.value.decodedData.endpoint) {\n        this['busy'] = false;\n        return;\n      }\n\n      if (!this.value.decodedData.port)\n        this.value.setData('port', 9440);\n\n      const os = new Nutanix(this.$store, {\n        endpoint:   this.value.decodedData.endpoint,\n        username:   this.value.decodedData.username,\n        password:   this.value.decodedData.password,\n        port:       this.value.decodedData.port,\n        insecure:   this.value.decodedData.insecure,\n      });\n\n      this['allowBusy'] = false;\n      this['busy'] = true;\n\n      const res = await os.testConnection();\n\n      if (res.error) {\n        okay = false;\n\n\n        if (res.error._status === 502 && !this.hostInAllowList()) {\n          this['errorAllowHost'] = true;\n        } else if (res.error._status === 401) {\n          this['error'] = \"Authentication Failed\";\n        } else {\n          this['error'] = res.error.message ? res.error.message : \"Something went wrong\";\n        }\n      } else {\n        okay = true;\n        this['success'] = `Welcome ${this.value.decodedData.username}, connected to ${this.value.decodedData.endpoint}`;\n      }\n\n      this['busy'] = false;\n      this.$emit('validationChanged', okay);\n    }\n  }\n};\n</script>\n\n<template>\n    <div class=\"row\">\n      <div class=\"col span-6\"> <!-- Endpoint -->\n        <LabeledInput\n          :value=\"value.decodedData.endpoint\"\n          :disabled=\"step !== 1\"\n          label-key=\"driver.nutanix.auth.fields.endpoint\"\n          placeholder-key=\"driver.nutanix.auth.placeholders.endpoint\"\n          type=\"text\"\n          :mode=\"mode\"\n          @update:value=\"value.setData('endpoint', $event);\"\n        />\n      </div>\n      <div class=\"col span-6\"> <!-- Port -->\n        <LabeledInput\n          :value=\"value.decodedData.port\"\n          :disabled=\"step !== 1\"\n          label-key=\"driver.nutanix.auth.fields.port\"\n          placeholder-key=\"driver.nutanix.auth.placeholders.port\"\n          type=\"text\"\n          :mode=\"mode\"\n          @update:value=\"value.setData('port', $event);\"\n        />\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col span-6\"> <!-- Username -->\n        <LabeledInput\n          :value=\"value.decodedData.username\"\n          :disabled=\"step !== 1\"\n          class=\"mt-20\"\n          label-key=\"driver.nutanix.auth.fields.username\"\n          placeholder-key=\"driver.nutanix.auth.placeholders.username\"\n          type=\"text\"\n          :mode=\"mode\"\n          @update:value=\"value.setData('username', $event);\"\n        />\n      </div>\n      <div class=\"col span-6\"> <!-- Password -->\n        <LabeledInput\n          :value=\"value.decodedData.password\"\n          :disabled=\"step !== 1\"\n          class=\"mt-20\"\n          label-key=\"driver.nutanix.auth.fields.password\"\n          placeholder-key=\"driver.nutanix.auth.placeholders.password\"\n          type=\"password\"\n          :mode=\"mode\"\n          @update:value=\"value.setData('password', $event);\"\n        />\n      </div>\n    </div>\n\n    <div class=\"row\">\n      <div class=\"col span-6\">\n        <Checkbox\n          class=\"mt-20\"\n          :value=\"value.decodedData.insecure\"\n          :valueWhenTrue=\"true\"\n          label-key=\"driver.nutanix.auth.fields.insecure\"\n          @update:value=\"value.setData('insecure', $event);\"\n          :disabled=\"true\"\n        />\n      </div>\n    </div>\n\n    <!-- Test Authentication -->\n    <button\n      ref=\"connect\"\n      class=\"btn role-primary mt-20 align-start\"\n      :disabled=\"step !== 1 || !canAuthenticate\"\n      :loading=\"step !== 1 || !canAuthenticate\"\n      @click=\"connect($event)\"\n    >\n      <i\n        v-if=\"busy\"\n        class=\"icon icon-lg icon-spinner icon-spin\"\n      />\n      <span\n        v-else\n        class=\"icon-spacer\"\n      />\n      <span>{{ t('driver.nutanix.auth.actions.authenticate') }}</span>\n      <span class=\"icon-spacer\" />\n    </button>\n\n    <Banner v-if=\"success\"\n      color=\"success\"\n      :closable=\"false\"\n    >\n      {{ success }}\n    </Banner>\n\n    <Banner\n      v-if=\"error\"\n      class=\"mt-20\"\n      color=\"error\"\n    >\n      {{ error }}\n    </Banner>\n\n    <Banner\n      v-if=\"errorAllowHost\"\n      color=\"error\"\n      class=\"allow-list-error\"\n    >\n      <div>\n        {{ t('driver.nutanix.auth.errors.notAllowed', { hostname }) }}\n      </div>\n      <button\n        :disabled=\"allowBusy\"\n        class=\"btn ml-10 role-primary\"\n        @click=\"addHostToAllowList\"\n      >\n        {{ t('driver.nutanix.auth.actions.addToAllowList') }}\n      </button>\n    </Banner>\n</template>\n<style lang=\"scss\" scoped>\n  .allow-list-error {\n    display: flex;\n\n    > :first-child {\n      flex: 1;\n    }\n  }\n  .icon-spacer {\n    width: 24px;\n  }\n\n  .align-start {\n    align-self: flex-start;\n  }\n</style>\n","import { render } from \"./nutanix.vue?vue&type=template&id=3f092f46&scoped=true\"\nimport script from \"./nutanix.vue?vue&type=script&lang=js\"\nexport * from \"./nutanix.vue?vue&type=script&lang=js\"\n\nimport \"./nutanix.vue?vue&type=style&index=0&id=3f092f46&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3f092f46\"]])\n\nexport default __exports__","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".allow-list-error[data-v-3f092f46]{display:flex}.allow-list-error[data-v-3f092f46]>:first-child{flex:1}.icon-spacer[data-v-3f092f46]{width:24px}.align-start[data-v-3f092f46]{align-self:flex-start}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n"],"names":["content","__esModule","default","module","id","locals","exports","add","Nutanix","constructor","$store","obj","_defineProperty","nutanixcredentialConfig","Object","keys","forEach","key","this","credentialID","$dispatch","dispatch","testConnection","baseUrl","endpoint","port","url","headers","Accept","btoa","username","password","res","method","redirectUnauthorized","root","_status","error","e","console","getClusterList","value","initial","getOptions","api","field","filter","cluster","config","hypervisorTypes","includes","getImages","getNetwork","mapper","async","vpc","network","subnetType","getVpc","vpcReference","data","undefined","baseName","name","clusterReference","clusterReferenceId","isExternal","makeComputeRequest","getStorageContainer","storage","clusterExtId","getCategories","categorie","getProjectsName","project","spec","constructTotalResponse","apiPath","initialDataLength","total","pageCount","Math","ceil","i","nextPageResponse","push","constructProjectTotalResponse","entities","options","busy","enabled","selected","isArray","metadata","total_matches","length","totalAvailableResults","list","k","Promise","all","map","convertToOptions","unique","index","findIndex","o","duplicates","found","find","option","JSON","stringify","sorted","sort","a","b","localeCompare","p","label","class","_createElementVNode","_hoisted_1","_hoisted_2","_createVNode","_component_LabeledInput","$props","decodedData","disabled","$data","step","type","mode","_cache","$event","setData","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_component_Checkbox","insecure","valueWhenTrue","ref","$options","canAuthenticate","loading","onClick","connect","_createElementBlock","_hoisted_10","_hoisted_11","_toDisplayString","_ctx","t","_hoisted_12","success","_createBlock","_component_Banner","color","closable","errorAllowHost","hostname","allowBusy","args","addHostToAllowList","_hoisted_13","components","Banner","LabeledInput","LabeledSelect","Checkbox","props","String","required","fetch","driver","computed","u","parseUrl","host","emits","methods","test","hostInAllowList","whitelistDomains","save","okay","os","message","$emit","__exports__","render","___CSS_LOADER_EXPORT___"],"sourceRoot":""}