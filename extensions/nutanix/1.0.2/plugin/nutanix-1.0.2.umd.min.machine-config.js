(("undefined"!==typeof self?self:this)["webpackChunknutanix_1_0_2"]=("undefined"!==typeof self?self:this)["webpackChunknutanix_1_0_2"]||[]).push([[921],{28:function(e,t,a){var i=a(4444);i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);var s=a(4825).A;s("7c138c14",i,!0,{sourceMap:!1,shadowMode:!1})},1071:function(e,t,a){var i=a(2655);i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);var s=a(4825).A;s("02f79a30",i,!0,{sourceMap:!1,shadowMode:!1})},1177:function(e,t,a){var i={"./csp/metadata.json":6471,"./federal/metadata.json":1862,"./harvester/metadata.json":1507,"./rgs/metadata.json":8401,"./suse/metadata.json":7259};function s(e){var t=n(e);return a(t)}function n(e){if(!a.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}s.keys=function(){return Object.keys(i)},s.resolve=n,e.exports=s,s.id=1177},1210:function(e,t,a){"use strict";a.d(t,{Y:function(){return r}});var i=a(5250),s=a(4364);function n(e,t,a){return(t=o(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e){var t=l(e,"string");return"symbol"==typeof t?t:t+""}function l(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}class r{constructor(e,t){n(this,"endpoint",""),n(this,"username",""),n(this,"password",""),n(this,"port",""),n(this,"insecure",!1),n(this,"clusterReferenceId",""),n(this,"credentialID",""),n(this,"endpoints",void 0),n(this,"$dispatch",void 0),t.nutanixcredentialConfig?(Object.keys(t.nutanixcredentialConfig).forEach((e=>{this[e]=t.nutanixcredentialConfig[e]})),this.credentialID=t.id):Object.keys(t).forEach((e=>{this[e]=t[e]})),this.$dispatch=e.dispatch}async testConnection(){const e=`/meta/proxy/${this.endpoint}:${this.port}`,t=`${e}/api/clustermgmt/v4.0/config/clusters`,a={Accept:"application/json","X-API-Auth-Header":"Basic "+btoa(this.username+":"+this.password)};try{const e=await this.$dispatch("management/request",{url:t,headers:a,method:"GET",redirectUnauthorized:!1},{root:!0});return 502===e._status?{error:"Could not proxy request - URL may not be in Rancher's allow list"}:e}catch(i){return s.error(i),{error:i}}}async getClusterList(e,t){return await this.getOptions({value:e,api:"/api/clustermgmt/v4.0/config/clusters",field:"data",filter:e=>e.config.hypervisorTypes.includes("AHV"),initial:t})}async getImages(e,t){return await this.getOptions({value:e,api:"/api/vmm/v4.0/content/images",field:"data",initial:t})}async getNetwork(e,t){return await this.getOptions({value:e,api:"/api/networking/v4.0/config/subnets",field:"data",mapper:async e=>{const t="OVERLAY"===e.subnetType?(await this.getVpc(e.vpcReference)).data:void 0;return{...e,baseName:e.name,name:"OVERLAY"===e.subnetType?`${e.name} (${t.name})`:e.name}},filter:e=>("OVERLAY"==e.subnetType||e.clusterReference==this.clusterReferenceId)&&!e.isExternal,initial:t})}async getVpc(e){return await this.makeComputeRequest(`/api/networking/v4.0/config/vpcs/${e}`)}async getStorageContainer(e,t){return await this.getOptions({value:e,api:"/api/clustermgmt/v4.0/config/storage-containers",field:"data",filter:e=>e.clusterExtId==this.clusterReferenceId,initial:t})}async getCategories(e,t){return await this.getOptions({value:e,api:"/api/prism/v4.0/config/categories",field:"data",mapper:e=>({...e,name:`${e.key}=${e.value}`}),filter:e=>"Project"!==e.key,initial:t})}async getProjectsName(e,t){return await this.getOptions({value:e,api:"/api/nutanix/v3/projects/list",field:"entities",mapper:e=>({...e,name:`${e.spec.name}`}),initial:t})}async constructTotalResponse(e,t,a){const i=Math.ceil(a/t),s=[];for(let n=1;n<i;n++){const t=await this.makeComputeRequest(`${e}?$page=${n}`);s.push(...t.data)}return s}async constructProjectTotalResponse(e,t,a){const i=Math.ceil(a/t),s=[];for(let n=1;n<i;n++){const t=await this.makeComputeRequest(`${e}?$page=${n}`,"POST");s.push(...t.entities)}return s}async getOptions(e){const{value:t,api:a,mapper:s,filter:n,initial:o,field:l}=e;let r;if(t.busy=!0,t.enabled=!0,t.selected=(0,i.isArray)(t.selected)?[]:"","/api/nutanix/v3/projects/list"===a){r=await this.makeComputeRequest(a,"POST");const e=r?.metadata?.total_matches??0,t=r?.entities?.length??0;if(t<e){const i=await this.constructProjectTotalResponse(a,t,e);r.entities=[...r.entities,...i]}}else{r=await this.makeComputeRequest(a);const e=r?.metadata?.totalAvailableResults??0,t=r?.data?.length??0;if(t<e){const i=await this.constructTotalResponse(a,t,e);r.data=[...r.data,...i]}}if(r&&r[l]){let e=r[l]||[];if(n&&(e=e.filter((e=>n(e)))),s&&(e=await Promise.all(e.map((async e=>await s(e))))),t.options.forEach((t=>{e.push(t)})),t.options=this.convertToOptions(e),t.busy=!1,t.options.length<e.length){const a=e.filter(((t,a)=>a!==e.findIndex((e=>t.name===e.name))));t.duplicates=a}if(o){const e=t.options.find((e=>e.value.name===o));e&&(t.selected=e.value)}}else t.options=[],t.selected=(0,i.isArray)(t.selected)?[]:null,t.busy=!1,t.enabled=!1}async makeComputeRequest(e,t="GET"){const a=`/meta/proxy/${this.endpoint}:${this.port}`,i=`${a}${e}`,n={Accept:"application/json","Content-Type":"application/json","X-API-Auth-Header":"Basic "+btoa(this.username+":"+this.password)};try{const e=await this.$dispatch("management/request",{url:i,headers:n,method:t,data:JSON.stringify({}),redirectUnauthorized:!1},{root:!0});return e}catch(o){s.error(o)}}convertToOptions(e){const t=e.filter(((t,a)=>a===e.findIndex((e=>t.name===e.name)))),a=(t||[]).sort(((e,t)=>e.name.localeCompare(t.name)));return a.map((e=>({label:e.name,value:e})))}}},2655:function(e,t,a){"use strict";a.r(t);var i=a(429),s=a.n(i),n=a(1214),o=a.n(n),l=o()(s());l.push([e.id,".addon.with-tooltip[data-v-554734c7]{position:relative;right:30px}",""]),t["default"]=l},2854:function(e,t,a){"use strict";a.r(t);var i=a(429),s=a.n(i),n=a(1214),o=a.n(n),l=o()(s());l.push([e.id,".validation-message{padding:5px;position:absolute;bottom:-35px}",""]),t["default"]=l},2946:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return je}});var i=a(9274);const s=e=>((0,i.pushScopeId)("data-v-1d8d4da4"),e=e(),(0,i.popScopeId)(),e),n={class:"nutanix-config"},o={class:"title"},l={key:0,class:"loading"},r=s((()=>(0,i.createElementVNode)("i",{class:"icon-spinner icon-spin icon-lg"},null,-1))),d={key:1,class:"loading"},u=s((()=>(0,i.createElementVNode)("i",{class:"icon-checkmark icon-lg",style:{color:"green"}},null,-1))),c={key:2,class:"loading"},p=s((()=>(0,i.createElementVNode)("i",{class:"icon-close icon-lg",style:{color:"red"}},null,-1))),m={class:"row mt-10"},h={class:"col span-6"},v={class:"col span-6"},g=s((()=>(0,i.createElementVNode)("hr",{class:"mt-10"},null,-1))),f={class:"nutanix-config"},b={class:"title"},y={class:"row mt-10"},C={class:"col span-4"},k={class:"col span-4"},x={class:"col span-4"},w={class:"row mt-10"},N={class:"col span-6"},S={class:"col span-6"},I={class:"row mt-10",style:{"align-items":"center"}},V={class:"col span-6"},E={class:"col span-6",style:{"padding-left":"10px"}},B={class:"nutanix-config"},A={class:"title"},$={class:"row mt-10"},z={class:"col span-12"},T={class:"row"},j={class:"col span-6"},D={class:"col span-6"},O=s((()=>(0,i.createElementVNode)("hr",{class:"mt-10"},null,-1))),P={class:"nutanix-config"},M={class:"title"},U={class:"row mt-10"},R={class:"col span-12"},L={key:1};function K(e,t,a,s,_,K){const q=(0,i.resolveComponent)("Loading"),F=(0,i.resolveComponent)("LabeledSelect"),H=(0,i.resolveComponent)("UnitInput"),G=(0,i.resolveComponent)("Checkbox"),W=(0,i.resolveComponent)("RadioGroup"),Y=(0,i.resolveComponent)("Collapse"),J=(0,i.resolveComponent)("CodeMirror"),Q=(0,i.resolveComponent)("Banner");return(0,i.openBlock)(),(0,i.createElementBlock)("div",null,[e.$fetchState.pending?((0,i.openBlock)(),(0,i.createBlock)(q,{key:0,delayed:!0})):(0,i.createCommentVNode)("",!0),(0,i.createElementVNode)("div",null,[(0,i.createElementVNode)("div",n,[(0,i.createElementVNode)("div",o,(0,i.toDisplayString)(e.t("driver.nutanix.config.title.main")),1),e.authenticating&&!e.ready?((0,i.openBlock)(),(0,i.createElementBlock)("div",l,[r,(0,i.createElementVNode)("span",null,(0,i.toDisplayString)(e.t("driver.nutanix.config.loggin.loading")),1)])):e.authenticating&&e.ready?((0,i.openBlock)(),(0,i.createElementBlock)("div",d,[u,(0,i.createElementVNode)("span",null,(0,i.toDisplayString)(e.t("driver.nutanix.config.loggin.success")),1)])):((0,i.openBlock)(),(0,i.createElementBlock)("div",c,[p,(0,i.createElementVNode)("span",null,(0,i.toDisplayString)(e.t("driver.nutanix.config.loggin.failed")),1)]))]),(0,i.createElementVNode)("div",m,[(0,i.createElementVNode)("div",h,[(0,i.createVNode)(F,{value:e.projectName.selected,"onUpdate:value":[t[0]||(t[0]=t=>e.projectName.selected=t),t[1]||(t[1]=e=>{K.dynamicProjectName(e),K.canAuthenticate()})],labelKey:"driver.nutanix.config.component.projectName.label",placeholder:e.t("driver.nutanix.config.component.projectName.placeholder"),options:e.projectName.options,disabled:!e.projectName.enabled||e.mybusy,loading:e.projectName.busy,searchable:!1},null,8,["value","placeholder","options","disabled","loading"])]),(0,i.createElementVNode)("div",v,[(0,i.createVNode)(F,{value:e.clusters.selected,"onUpdate:value":[t[2]||(t[2]=t=>e.clusters.selected=t),t[3]||(t[3]=e=>{K.setClusterReferenceId(e),K.canAuthenticate()})],labelKey:"driver.nutanix.config.component.cluster.label",placeholder:e.t("driver.nutanix.config.component.cluster.placeholder"),options:e.clusters.options,disabled:!e.clusters.enabled||e.mybusy,loading:e.clusters.busy,searchable:!1,required:!0},null,8,["value","placeholder","options","disabled","loading"])])]),g,(0,i.createElementVNode)("div",f,[(0,i.createElementVNode)("div",b,(0,i.toDisplayString)(e.t("driver.nutanix.config.title.properties")),1)]),(0,i.createElementVNode)("div",y,[(0,i.createElementVNode)("div",C,[(0,i.createVNode)(H,{value:e.vmCpus.selected,labelKey:"driver.nutanix.config.component.vmCpus.label",suffix:e.t("driver.nutanix.config.component.vmCpus.suffix"),type:"number",disabled:!e.vmCpus.enabled||e.mybusy,loading:e.vmCpus.busy,required:!0,min:e.vmCpus.min,max:e.vmCpus.max,"onUpdate:value":t[4]||(t[4]=t=>{K.validInput(t,e.vmCpus),K.canAuthenticate()}),status:e.vmCpus.status,tooltip:e.vmCpus.tooltip},null,8,["value","suffix","disabled","loading","min","max","status","tooltip"]),(0,i.createVNode)(G,{value:e.vmCpuPassthrough,valueWhenTrue:!0,labelKey:"driver.nutanix.config.component.vmCpuPassthrough.label",style:{"margin-top":"5px"},"onUpdate:value":t[5]||(t[5]=t=>{e.vmCpuPassthrough=!e.vmCpuPassthrough}),disabled:e.mybusy},null,8,["value","disabled"])]),(0,i.createElementVNode)("div",k,[(0,i.createVNode)(H,{value:e.vmCores.selected,labelKey:"driver.nutanix.config.component.vmCores.label",suffix:e.t("driver.nutanix.config.component.vmCores.suffix"),type:"number",disabled:!e.vmCores.enabled||e.mybusy,loading:e.vmCores.busy,required:!0,min:e.vmCores.min,max:e.vmCores.max,onKeyup:t[6]||(t[6]=t=>{K.validInput(t,e.vmCores),K.canAuthenticate()}),"onUpdate:value":t[7]||(t[7]=t=>{K.validInput(t,e.vmCores),K.canAuthenticate()}),status:e.vmCores.status,tooltip:e.vmCores.tooltip},null,8,["value","suffix","disabled","loading","min","max","status","tooltip"])]),(0,i.createElementVNode)("div",x,[(0,i.createVNode)(H,{value:e.vmMem.selected,labelKey:"driver.nutanix.config.component.vmMem.label",suffix:e.t("driver.nutanix.config.component.vmMem.suffix"),type:"number",disabled:!e.vmMem.enabled||e.mybusy,loading:e.vmMem.busy,required:!0,min:e.vmMem.min,max:e.vmMem.max,"onUpdate:value":t[8]||(t[8]=t=>{K.validInput(t,e.vmMem),K.canAuthenticate()}),status:e.vmMem.status,tooltip:e.vmMem.tooltip},null,8,["value","suffix","disabled","loading","min","max","status","tooltip"])])]),(0,i.createElementVNode)("div",w,[(0,i.createElementVNode)("div",N,[(0,i.createVNode)(F,{value:e.vmImage.selected,"onUpdate:value":[t[9]||(t[9]=t=>e.vmImage.selected=t),t[10]||(t[10]=e=>{K.dynamicVmImageSize(e),K.canAuthenticate()})],labelKey:"driver.nutanix.config.component.vmImage.label",placeholder:e.t("driver.nutanix.config.component.vmImage.placeholder"),options:e.vmImage.options,disabled:!e.vmImage.enabled||e.mybusy,loading:e.vmImage.busy,searchable:!1,required:!0,status:e.vmImage.status,tooltip:e.vmImage.tooltip},null,8,["value","placeholder","options","disabled","loading","status","tooltip"])]),(0,i.createElementVNode)("div",S,[(0,i.createVNode)(H,{value:e.vmImageSize.selected,labelKey:"driver.nutanix.config.component.vmImageSize.label",suffix:e.t("driver.nutanix.config.component.vmImageSize.suffix"),min:e.vmImageSize.min,max:e.vmImageSize.max,disabled:!e.vmImageSize.enabled||e.mybusy,loading:e.vmImageSize.busy,required:!0,type:"number","onUpdate:value":t[11]||(t[11]=t=>{K.validInput(t,e.vmImageSize),K.canAuthenticate()}),status:e.vmImageSize.status,tooltip:e.vmImageSize.tooltip},null,8,["value","suffix","min","max","disabled","loading","status","tooltip"])])]),(0,i.createElementVNode)("div",I,[(0,i.createElementVNode)("div",V,[(0,i.createVNode)(F,{value:e.networks.selected,"onUpdate:value":[t[12]||(t[12]=t=>e.networks.selected=t),t[13]||(t[13]=t=>{K.labelSelectAddWrongTag(t,e.networks),K.filterNetworks(),K.canAuthenticate()})],labelKey:"driver.nutanix.config.component.vmNetwork.label",placeholder:e.t("driver.nutanix.config.component.vmNetwork.placeholder"),taggable:!0,multiple:!0,options:e.networks.options,disabled:!e.networks.enabled||e.mybusy,loading:e.networks.busy,searchable:!0,required:!0},null,8,["value","placeholder","options","disabled","loading"])]),(0,i.createElementVNode)("div",E,[(0,i.createElementVNode)("div",B,[(0,i.createElementVNode)("div",A,(0,i.toDisplayString)(e.t("driver.nutanix.config.title.bootType")),1)]),(0,i.createVNode)(W,{name:"bootConfiguration",options:["Legacy","UEFI"],row:!0,value:e.bootType,"onUpdate:value":t[14]||(t[14]=t=>e.bootType=t),disabled:e.mybusy},null,8,["value","disabled"])])]),(0,i.createElementVNode)("div",$,[(0,i.createElementVNode)("div",z,[(0,i.createVNode)(F,{value:e.vmCategories.selected,"onUpdate:value":t[15]||(t[15]=t=>e.vmCategories.selected=t),labelKey:"driver.nutanix.config.component.vmCategories.label",placeholder:e.t("driver.nutanix.config.component.vmCategories.placeholder"),taggable:!0,multiple:!0,options:e.vmCategories.options,disabled:!e.vmCategories.enabled||e.mybusy,loading:e.vmCategories.busy,onSelecting:t[16]||(t[16]=t=>K.labelSelectAddWrongTag(t,e.vmCategories))},null,8,["value","placeholder","options","disabled","loading"])])]),(0,i.createVNode)(G,{val:"",value:e.vmSerialPort,valueWhenTrue:!0,labelKey:"driver.nutanix.config.component.vmSerialPort.label",style:{"margin-top":"5px"},"onUpdate:value":t[17]||(t[17]=t=>{e.vmSerialPort=!e.vmSerialPort}),disabled:e.mybusy},null,8,["value","disabled"]),(0,i.createVNode)(Y,{open:e.is_SC_colapse,title:e.t("driver.nutanix.config.title.collapseAdditionalDisk"),"onUpdate:open":t[21]||(t[21]=t=>e.is_SC_colapse=!e.is_SC_colapse)},{default:(0,i.withCtx)((()=>[(0,i.createElementVNode)("div",null,[(0,i.createElementVNode)("div",T,[(0,i.createElementVNode)("div",j,[(0,i.createVNode)(H,{value:e.additionalDiskSize.selected,labelKey:"driver.nutanix.config.component.diskSize.label",suffix:e.t("driver.nutanix.config.component.diskSize.suffix"),type:"number",disabled:!e.additionalDiskSize.enabled||e.mybusy,loading:e.additionalDiskSize.busy,"onUpdate:value":t[18]||(t[18]=e=>{K.dynamicStorageContainer(e),K.canAuthenticate()})},null,8,["value","suffix","disabled","loading"])]),(0,i.createElementVNode)("div",D,[(0,i.createVNode)(F,{value:e.storageContainer.selected,"onUpdate:value":[t[19]||(t[19]=t=>e.storageContainer.selected=t),t[20]||(t[20]=e=>K.canAuthenticate())],labelKey:"driver.nutanix.config.component.storageContainer.label",placeholder:e.t("driver.nutanix.config.component.storageContainer.placeholder"),options:e.storageContainer.options,disabled:!e.additionalDiskSize.selected||!e.storageContainer.enabled||e.mybusy,loading:e.storageContainer.busy,searchable:!1},null,8,["value","placeholder","options","disabled","loading"])])])])])),_:1},8,["open","title"]),O,(0,i.createElementVNode)("div",P,[(0,i.createElementVNode)("div",M,(0,i.toDisplayString)(e.t("driver.nutanix.config.title.cloudInit")),1)]),(0,i.createElementVNode)("div",U,[(0,i.createElementVNode)("div",R,[(0,i.createVNode)(J,{style:{background:"#f5f5f5"},mode:"edit",minHeight:"5",value:e.cloudInit,options:e.mybusy?{readOnly:!0,cursorBlinkRate:-1}:{readOnly:!1},asTextArea:!1,onOnInput:t[22]||(t[22]=t=>e.cloudInit=t)},null,8,["value","options"])])])]),e.errors.length?((0,i.openBlock)(),(0,i.createElementBlock)("div",L,[((0,i.openBlock)(!0),(0,i.createElementBlock)(i.Fragment,null,(0,i.renderList)(e.errors,((e,t)=>((0,i.openBlock)(),(0,i.createElementBlock)("div",{key:t},[(0,i.createVNode)(Q,{color:"error",label:K.stringify(e)},null,8,["label"])])))),128))])):(0,i.createCommentVNode)("",!0)])}var q=a(9822),F=a(9980),H=a(6414),G=a(7093),W=a(5215),Y=a(3801),J=a(3950),Q=a(5953),X=a(9038),Z=a(5664),ee=a(9726),te=a(4220),ae=a(1210);function ie(e,t,a,s,n,o){const l=(0,i.resolveComponent)("LabeledInput");return(0,i.openBlock)(),(0,i.createBlock)(l,(0,i.mergeProps)({ref:"value",value:o.displayValue},e.$attrs,{type:"number",min:a.min,mode:a.mode,label:a.label,delay:a.delay,"label-key":a.labelKey,tooltip:a.tooltip,"tooltip-key":a.tooltipKey,required:a.required,placeholder:a.placeholder,"hide-arrows":a.hideArrows,onChange:t[0]||(t[0]=e=>o.update(e.target.value)),onBlur:t[1]||(t[1]=e=>o.update(e.target.value)),onKeyup:t[2]||(t[2]=e=>o.update(e.target.value,"keyup"))}),{suffix:(0,i.withCtx)((()=>[o.displayUnit?((0,i.openBlock)(),(0,i.createElementBlock)("div",{key:0,class:(0,i.normalizeClass)(["addon",{"with-tooltip":a.tooltip||a.tooltipKey}])},(0,i.toDisplayString)(o.displayUnit),3)):(0,i.createCommentVNode)("",!0)])),_:1},16,["value","min","mode","label","delay","label-key","tooltip","tooltip-key","required","placeholder","hide-arrows"])}var se=a(5799);const ne={key:0},oe={key:2,class:"required"},le=["maxlength","disabled","type","value","placeholder","data-lpignore"],re={key:2,class:"sub-label"},de={key:0},ue={key:1};function ce(e,t,a,s,n,o){const l=(0,i.resolveComponent)("t"),r=(0,i.resolveComponent)("TextAreaAutoGrow"),d=(0,i.resolveComponent)("LabeledTooltip"),u=(0,i.resolveDirective)("clean-html");return(0,i.openBlock)(),(0,i.createElementBlock)("div",{class:(0,i.normalizeClass)({"labeled-input":!0,focused:e.focused,[e.mode]:!0,disabled:e.isDisabled,[e.status]:e.status,suffix:e.hasSuffix,"v-popper--has-tooltip":e.hasTooltip,"compact-input":e.isCompact,hideArrows:e.hideArrows,[e.className]:!0})},[(0,i.renderSlot)(e.$slots,"label",{},(()=>[e.hasLabel?((0,i.openBlock)(),(0,i.createElementBlock)("label",ne,[e.labelKey?((0,i.openBlock)(),(0,i.createBlock)(l,{key:0,k:e.labelKey},null,8,["k"])):e.label?((0,i.openBlock)(),(0,i.createElementBlock)(i.Fragment,{key:1},[(0,i.createTextVNode)((0,i.toDisplayString)(e.label),1)],64)):(0,i.createCommentVNode)("",!0),e.requiredField?((0,i.openBlock)(),(0,i.createElementBlock)("span",oe,"*")):(0,i.createCommentVNode)("",!0)])):(0,i.createCommentVNode)("",!0)]),!0),(0,i.renderSlot)(e.$slots,"prefix",{},void 0,!0),(0,i.renderSlot)(e.$slots,"field",{},(()=>["multiline"===e.type||"multiline-password"===e.type?((0,i.openBlock)(),(0,i.createBlock)(r,(0,i.mergeProps)({key:0,ref:"value"},e.$attrs,{maxlength:e._maxlength,disabled:e.isDisabled,value:e.value||"",placeholder:e._placeholder,autocapitalize:"off",class:{conceal:"multiline-password"===e.type},"onUpdate:value":e.onInput,onFocus:e.onFocus,onBlur:e.onBlur}),null,16,["maxlength","disabled","value","placeholder","class","onUpdate:value","onFocus","onBlur"])):((0,i.openBlock)(),(0,i.createElementBlock)("input",(0,i.mergeProps)({key:1,ref:"value",class:{"no-label":!e.hasLabel}},e.$attrs,{maxlength:e._maxlength,disabled:e.isDisabled,type:"cron"===e.type?"text":e.type,value:e.value,placeholder:e._placeholder,autocomplete:"off",autocapitalize:"off","data-lpignore":e.ignorePasswordManagers,onInput:t[0]||(t[0]=(...t)=>e.onInput&&e.onInput(...t)),onFocus:t[1]||(t[1]=(...t)=>e.onFocus&&e.onFocus(...t)),onBlur:t[2]||(t[2]=(...t)=>e.onBlur&&e.onBlur(...t)),onChange:t[3]||(t[3]=(...t)=>e.onChange&&e.onChange(...t)),onKeyup:t[4]||(t[4]=t=>e.$emit("keyup",t))}),null,16,le))]),!0),(0,i.renderSlot)(e.$slots,"suffix",{},void 0,!0),e.hasTooltip?((0,i.openBlock)(),(0,i.createBlock)(d,{key:0,hover:e.hoverTooltip,value:e.tooltipValue,status:e.status},null,8,["hover","value","status"])):(0,i.createCommentVNode)("",!0),e.validationMessage?((0,i.openBlock)(),(0,i.createBlock)(d,{key:1,hover:e.hoverTooltip,value:e.validationMessage},null,8,["hover","value"])):(0,i.createCommentVNode)("",!0),e.cronHint||e.subLabel?((0,i.openBlock)(),(0,i.createElementBlock)("div",re,[e.cronHint?((0,i.openBlock)(),(0,i.createElementBlock)("div",de,(0,i.toDisplayString)(e.cronHint),1)):(0,i.createCommentVNode)("",!0),e.subLabel?(0,i.withDirectives)(((0,i.openBlock)(),(0,i.createElementBlock)("div",ue,null,512)),[[u,e.subLabel]]):(0,i.createCommentVNode)("",!0)])):(0,i.createCommentVNode)("",!0)],2)}var pe=a(9378),me=a(8993),he=a(2043),ve=a(7021),ge=a.n(ve),fe=a(3369),be=a(5250),ye=a(2117),Ce=a(5089);const ke={onInput(){}};var xe=(0,i.defineComponent)({components:{LabeledTooltip:me.A,TextAreaAutoGrow:pe.A},inheritAttrs:!1,props:{...ye.K,type:{type:String,default:"text"},status:{type:String,default:null},subLabel:{type:String,default:null},tooltip:{default:null,type:[String,Object]},hoverTooltip:{type:Boolean,default:!0},ignorePasswordManagers:{default:!1,type:Boolean},maxlength:{type:Number,default:null},hideArrows:{type:Boolean,default:!1},delay:{type:Number,default:0},class:{type:String,default:""}},emits:["change","update:value","blur","update:validation"],setup(e,{emit:t}){const{focused:a,onFocusLabeled:s,onBlurLabeled:n,isDisabled:o,validationMessage:l,requiredField:r}=(0,ye.x)(e,t),{isCompact:d}=(0,Ce.v)(e),u=(0,i.inject)("onInput",ke.onInput);return{focused:a,onFocusLabeled:s,onBlurLabeled:n,onInput:u,isDisabled:o,validationMessage:l,requiredField:r,isCompact:d}},data(){return{updated:!1,validationErrors:""}},computed:{hasLabel(){return!this.isCompact&&(!!this.label||!!this.labelKey||!!this.$slots.label)},hasTooltip(){return!!this.tooltip||!!this.tooltipKey},tooltipValue(){if(this.hasTooltip)return this.tooltipKey?this.t(this.tooltipKey):this.tooltip},hasSuffix(){return!!this.$slots.suffix},cronHint(){if("cron"===this.type&&this.value){if(!(0,fe.isValidCron)(this.value,{alias:!0,allowBlankDay:!0,allowSevenAsSunday:!0}))return this.t("generic.invalidCron");try{const e=ge().toString(this.value||"",{verbose:!0});return e}catch(e){return this.t("generic.invalidCron")}}},_placeholder(){return this.placeholder?this.placeholder.toString():this.placeholderKey?this.t(this.placeholderKey):""},_maxlength(){if("text"===this.type&&this.maxlength)return this.maxlength},className(){return this.class}},created(){this.onInput=this.delay?(0,be.debounce)(this.delayInput,this.delay):this.delayInput},methods:{focus(){const e=this.$refs.value;e&&e.focus()},select(){const e=this.$refs.value;e&&e.select()},onChange(e){this.$emit("change",e)},delayInput(e){const t="string"===typeof e?e:e?.target?.value;this.$emit("update:value",t)},onFocus(){this.onFocusLabeled()},onBlur(e){this.$emit("blur",e),this.onBlurLabeled()},escapeHtml:he.ZD}}),we=(a(5097),a(5955),a(7433));const Ne=(0,we.A)(xe,[["render",ce],["__scopeId","data-v-3ae411d0"]]);var Se=Ne,Ie={components:{LabeledInput:Se},emits:["update:value","update:validation","change","blur"],props:{outputAs:{type:String,default:"number"},outputModifier:{type:Boolean,default:!1},inputExponent:{type:Number,default:0},baseUnit:{type:String,default:"B"},hideArrows:{type:Boolean,default:!1},increment:{type:Number,default:1e3},suffix:{type:String,default:null},mode:{type:String,default:te.G5},value:{type:[Number,String],default:null},label:{type:String,default:null},labelKey:{type:String,default:null},tooltip:{type:[String,Object],default:null},tooltipKey:{type:String,default:null},required:{type:Boolean,default:!1},min:{type:[Number,String],default:0},placeholder:{type:[String,Number],default:""},delay:{type:Number,default:0},positive:{type:Boolean,default:!1}},computed:{unit(){let e;return e=this.inputExponent>=0?se.QN[this.inputExponent]:se.kq[-1*this.inputExponent],1024===this.increment&&e&&(e+="i"),e},parsedValue(){return"string"===typeof this.value?(0,se.ao)(this.value):this.value},displayValue(){let e="";return(this.parsedValue||0===this.parsedValue)&&(e=(0,se.Mo)(this.parsedValue,{increment:this.increment,addSuffix:!1,maxExponent:this.inputExponent,minExponent:this.inputExponent})),e},displayUnit(){return this.suffix?this.suffix:this.unit+this.baseUnit}},methods:{focus(){const e=this.$refs.value;e&&e.focus()},update(e){let t=""===e?null:e;this.positive&&e<0&&(t=0),this.outputModifier?t=null===t?null:`${e}${this.unit}`:"string"===this.outputAs?t=null===t?"":`${e}`:t&&(t=this.unit?(0,se.ao)(`${t}${this.unit}`):parseInt(t)),this.$emit("update:value",t)}}};a(1071);const Ve=(0,we.A)(Ie,[["render",ie],["__scopeId","data-v-554734c7"]]);var Ee=Ve,Be=a(4364);function Ae(e=!1,t=null,a=[]){return{options:a,selected:t,busy:!1,enabled:e,baseOption:null}}function $e(e=!1,t=null,a=null,i=null){return{options:[],selected:t,min:a,max:i,busy:!1,enabled:e,status:"",tooltip:""}}var ze={components:{Banner:F.l,Loading:q.A,KeyValue:W.A,LabeledSelect:G.A,UnitInput:Ee,CodeMirror:Y.A,Collapse:J.A,Checkbox:Q.A,RadioGroup:X.A},mixins:[H.A],props:{uuid:{type:String,required:!0},cluster:{type:Object,default:()=>({})},credentialId:{type:String,required:!0},disabled:{type:Boolean,default:!1},busy:{type:Boolean,default:!1},provider:{type:String,required:!0}},emits:["validationChanged"],async fetch(){this.credentialId&&(this.$emit("validationChanged",!1),this.mode!=te.YQ?(await this.initAuthentication(),this.clusters.selected=this.clusters.baseOption.filter((e=>e.label==this.value.cluster))[0],void 0!==this.clusters.selected&&(await this.setClusterReferenceId(this.clusters.selected.value),this.projectName.selected=this.projectName.options.find((e=>e.value.name===this.value.project))?.value,this.vmCpus.selected=this.value.vmCpus,this.vmCpuPassthrough=this.value.vmCpuPassthrough,this.vmCores.selected=this.value.vmCores,this.vmMem.selected=this.value.vmMem/1024,this.vmImage.selected=this.vmImage.options.find((e=>e.value.name===this.value.vmImage))?.value,this.vmImageSize.selected=this.value.vmImageSize,this.networks.selected=this.value.vmNetwork.map((e=>this.networks.baseOption.find((t=>t.value.extId===e||t.extId===e)))),this.filterNetworks(),this.bootType="legacy"===this.value.bootType?"Legacy":"UEFI",this.vmCategories.selected=this.value.vmCategories.map((e=>this.vmCategories.options.find((t=>t.name===e||t.value?.name===e)))),this.vmSerialPort=this.value.vmSerialPort,this.additionalDiskSize.selected=this.value.diskSize,0!==this.additionalDiskSize.selected&&null!==this.additionalDiskSize.selected&&(this.storageContainer.selected=this.storageContainer.options.find((e=>e.value.containerExtId===this.value.storageContainer))),this.cloudInit=this.value.cloudInit,this.$emit("validationChanged",!0),this.mode==te.nW&&(this.mybusy=!0))):this.initAuthentication())},data(){return this.InitData()},watch:{credentialId(){this.$fetch()},value(e,t){t.vmCategories,t.vmNetwork;this.vmCategories.selected.length?this.value.vmCategories=void 0===this.vmCategories.selected[0]?.label?this.vmCategories.selected.map((e=>e.name)):this.vmCategories.selected.map((e=>e.value.name)):this.value.vmCategories=[];const a=_.uniq(this.value.vmNetwork);this.value.vmNetwork=[...a]}},computed:{value(){return this.value}},methods:{stringify:ee.As,async initAuthentication(){let e=this.InitData();Object.keys(e).forEach((t=>{this[t]=e[t]}));try{this.credential=await this.$store.dispatch("rancher/find",{type:Z.k$.CLOUD_CREDENTIAL,id:this.credentialId})}catch(a){this.credential=null}try{const e=this.credentialId.replace(":","/"),t=await this.$store.dispatch("management/find",{type:Z.bB,id:e}),a=t.data["nutanixcredentialConfig-password"],i=atob(a);this.password=i,this.havePassword=!0,this.ready=!0}catch(a){this.password="",this.havePassword=!1,Be.error(a)}this["authenticating"]=!0;const t=new ae.Y(this.$store,this.credential);t.password=this.password,this.os=t,await this.setConfiguration()},InitData(){return{authenticating:!1,ready:!1,os:null,password:null,havePassword:!1,clusters:Ae(),clusterReferenceId:"",projectName:Ae(!0,null,[{name:"-- NO PROJECT --"}]),vmCpus:$e(!0,"2",2,128),vmCpuPassthrough:!1,vmCores:$e(!0,"1",1,128),vmMem:$e(!0,"4",4,512),vmImage:Ae(),vmImageSize:$e(!0,"0",0,1e4),networks:Ae(!1,[]),additionalDiskSize:Ae(!1,0),storageContainer:Ae(),is_SC_colapse:!1,cloudInit:"#cloud-config\n\n",vmCategories:Ae(!1,[]),vmSerialPort:!1,bootType:"Legacy",t:this.$store.getters["i18n/t"],mybusy:!1,errors:[]}},async setConfiguration(){if(await this.os.getProjectsName(this.projectName,this.value?.projectName),!this.projectName.enabled)return this["authenticating"]=!1,void this.errors.push("Unable to get Nutanix Projects Name");await this.os.getClusterList(this.clusters,this.value?.clusterName).then((()=>{this.clusters.enabled||this.errors.push("Unable to get Nutanix cluster"),this.clusters.baseOption=this.clusters.options,this.networks.enabled=!1})),await this.os.getImages(this.vmImage,this.value?.imageName).then((()=>{this.vmImage.enabled||this.errors.push("Unable to get Nutanix Images")})),await this.os.getCategories(this.vmCategories,this.value?.vmCategories).then((()=>{this.vmCategories.enabled||this.errors.push("Unable to get Nutanix vmCategories")}))},async setClusterReferenceId(e){this.os.clusterReferenceId=e.extId,this.networks.options=[],this.storageContainer.options=[],await this.os.getNetwork(this.networks,this.value?.vmNetwork).then((()=>{if(this.networks.enabled||this.errors.push("Unable to get Nutanix Network"),this.networks.baseOption=this.networks.options,this.projectName.selected){let e=this.projectName.selected.status.resources.subnet_reference_list.map((e=>e.uuid));this.networks.options=this.networks.baseOption.filter((t=>e.includes(t.value.extId))),this.networks.baseOption=this.networks.options}0===this.networks.options.length?this.networks.enabled=!1:this.networks.enabled=!0})),await this.os.getStorageContainer(this.storageContainer,this.value?.storageContainer).then((()=>{this.storageContainer.enabled||this.errors.push("Unable to get Nutanix storageContainer"),this.additionalDiskSize.enabled=!0}))},dynamicProjectName(e){if("-- NO PROJECT --"==this.projectName.selected?.name)this.projectName.selected=null,this.clusters.options=this.clusters.baseOption;else{let t=e.status.resources.cluster_reference_list.map((e=>e.uuid));this.clusters.options=this.clusters.baseOption.filter((e=>t.includes(e.value.extId)))}this.clusters.selected=null,this.networks.selected=[],this.networks.enabled=!1,this.additionalDiskSize.selected=0,this.additionalDiskSize.enabled=!1,this.storageContainer.selected=null,0===this.clusters.options.length?this.clusters.enabled=!1:this.clusters.enabled=!0},dynamicVmImageSize(e){this.vmImageSize.min=10+Math.ceil(e.sizeBytes/1073741824),this.vmImageSize.selected=10+Math.ceil(e.sizeBytes/1073741824),void 0!==this.vmImage?.duplicates?.find((t=>t.name===e.name))?(this.vmImage.status="warning",this.vmImage.tooltip=this.t("driver.nutanix.config.component.vmImage.duplicates")):(this.vmImage.status="",this.vmImage.tooltip="")},filterNetworks(){0!==this.networks.selected.length?this.networks.selected[0]?.subnetType?this.networks.options=this.networks.baseOption.filter((e=>{const t=this.networks.selected[0];return t.subnetType===e.value.subnetType&&t.vpcReference===e.value.vpcReference&&t.isAdvancedNetworking===e.value.isAdvancedNetworking})):(this.networks.selected=this.networks.selected.filter((e=>e.value)),this.networks.options=this.networks.baseOption.filter((e=>{const t=this.networks.selected[0];return t.value.subnetType===e.value.subnetType&&t.value.vpcReference==e.value.vpcReference&&t.value.isAdvancedNetworking===e.value.isAdvancedNetworking}))):this.networks.options=this.networks.baseOption},dynamicStorageContainer(e){this.additionalDiskSize.selected=e,0!==this.additionalDiskSize.selected&&null!==this.additionalDiskSize.selected?this.storageContainer.enabled=!0:this.storageContainer.enabled=!1},labelSelectAddWrongTag(e,t){t.selected=e.filter((e=>e))},syncValue(){this.value.cluster=this.clusters.selected?.value?.name??this.clusters.selected.name,this.value.project="-- NO PROJECT --"==this.projectName.selected?.name?null:this.projectName.selected?.name,this.value.vmCpus=this.vmCpus.selected.toString(),this.value.vmCpuPassthrough=this.vmCpuPassthrough,this.value.vmCores=this.vmCores.selected.toString(),this.value.vmMem=(1024*this.vmMem.selected).toString(),this.value.vmImage=this.vmImage.selected?.name,this.value.vmImageSize=this.vmImageSize.selected.toString();const e=_.uniq(this.networks.selected.map((e=>e.extId)));this.value.vmNetwork=e,this.value.bootType=this.bootType.toLowerCase(),this.vmCategories.selected.length?this.value.vmCategories=void 0===this.vmCategories.selected[0]?.label?this.vmCategories.selected.map((e=>e.name)):this.vmCategories.selected.map((e=>e.value.name)):this.value.vmCategories=[],this.value.vmSerialPort=this.vmSerialPort,null!==this.additionalDiskSize.selected?this.value.diskSize=this.additionalDiskSize.selected.toString():this.value.diskSize=this.additionalDiskSize.selected,0!==this.additionalDiskSize.selected&&null!==this.additionalDiskSize.selected&&(this.value.storageContainer=this.storageContainer.selected?.containerExtId),this.value.cloudInit=this.cloudInit},validInput(e,t){t.selected=e,t.selected<t.min||t.selected>t.max?(t.status="error",t.tooltip=this.t("driver.nutanix.config.component.vmCpus.tooltip")+` (${t.min} - ${t.max})`):(t.status="",t.tooltip="")},canAuthenticate(){(0===this.additionalDiskSize.selected||null===this.additionalDiskSize.selected||""!==this.storageContainer.selected)&&this.clusters.selected&&this.vmCpus.selected&&this.vmCores.selected&&this.vmMem.selected&&this.vmImage.selected&&this.vmImageSize.selected&&this.networks.selected.length>0?this.$emit("validationChanged",!0):this.$emit("validationChanged",!1)},test(){this.syncValue()}}};a(28);const Te=(0,we.A)(ze,[["render",K],["__scopeId","data-v-1d8d4da4"]]);var je=Te},4444:function(e,t,a){"use strict";a.r(t);var i=a(429),s=a.n(i),n=a(1214),o=a.n(n),l=o()(s());l.push([e.id,".file-button[data-v-1d8d4da4]{align-items:center;position:absolute;top:0;right:0;height:100%;display:flex}.file-button>.file-selector[data-v-1d8d4da4]{height:59px;border-top-left-radius:0;border-bottom-left-radius:0}.nutanix-config[data-v-1d8d4da4]{display:flex;align-items:center}.nutanix-config>.title[data-v-1d8d4da4]{font-weight:700;padding:4px 0}.nutanix-config>.loading[data-v-1d8d4da4]{margin-left:20px;display:flex;align-items:center}.nutanix-config>.loading>i[data-v-1d8d4da4]{margin-right:4px}",""]),t["default"]=l},5097:function(e,t,a){var i=a(8441);i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);var s=a(4825).A;s("49b654b5",i,!0,{sourceMap:!1,shadowMode:!1})},5955:function(e,t,a){var i=a(2854);i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);var s=a(4825).A;s("205f8f32",i,!0,{sourceMap:!1,shadowMode:!1})},8441:function(e,t,a){"use strict";a.r(t);var i=a(429),s=a.n(i),n=a(1214),o=a.n(n),l=o()(s());l.push([e.id,".labeled-input.view input[data-v-3ae411d0]{text-overflow:ellipsis}.hideArrows input[data-v-3ae411d0]::-webkit-inner-spin-button,.hideArrows input[data-v-3ae411d0]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.hideArrows input[type=number][data-v-3ae411d0]{-moz-appearance:textfield}",""]),t["default"]=l}}]);
//# sourceMappingURL=nutanix-1.0.2.umd.min.machine-config.js.map